{
    "openapi": "3.0.0",
    "info": {
        "title": "User Info API",
        "description": "User Info allows Dappre users to share data with your website in three steps:<ul><li>[The users opens your website with a url and a secret](#/Website/Website%20call)<li>[Use the url to get the data](#/User%20Info/Get%20encrypted%20User%20Info)<li>Use the secret to decrypt the data</ul><p>The api contains example data for experimentation, but to test with the Dappre app please contact the Service Desk and provide:<ul><li>your website url for test (and production)<li>your preferred encryption algorithm (AES128, AES192, AES256)</ul>",
        "externalDocs": {
            "description": "Find more info here",
            "url": "https://dappre.com"
        },
        "version": "1.0.0",
        "license": {
            "name": "(c) Dappre BV 2019 - All rights reserved",
            "url": "https://dappre.com"
        }
    },
    "paths": {
        "/{Website}": {
            "get": {
                "tags": [
                    "Website"
                ],
                "description": "Website call from eCard",
                "operationId": "Website call",
                "responses": {
                    "200": {
                        "description": "Website page"
                    }
                }
            },
            "servers": [
                {
                    "description": "Website",
                    "url": "{WebsiteUrl}",
                    "variables": {
                        "WebsiteBaseUrl": {
                            "description": "(base part of) Website url",
                            "default": "https://website.example.com"
                        }
                    }
                }
            ],
            "parameters": [
                {
                    "name": "Website url",
                    "in": "path",
                    "description": "(path part of) Website url, for example 'home' for 'https://website.example.com/home'.",
                    "required": true
                },
                {
                    "name": "s",
                    "in": "query",
                    "description": "secret. Contact the Service Desk to change the parameter name.",
                    "schema": {
                        "$ref": "#/components/schemas/secret"
                    }
                },
                {
                    "name": "url",
                    "in": "query",
                    "description": "User Info Url. Contact the Service Desk to change the parameter name.",
                    "schema": {
                        "$ref": "#/components/schemas/url"
                    }
                }
            ]
        },
        "/{urlPath}": {
            "get": {
                "tags": [
                    "User Info"
                ],
                "description": "Get encrypted data using provided url, for an example: [click here](https://card.dolden.net/ecards/v1/pub/dataExchange/SCXPNE2I3D4JU5NWDDTAXRCBBEJQWJX5).<p>The data is cached for 10 minutes by default, so .",
                "operationId": "Get encrypted User Info",
                "responses": {
                    "200": {
                        "$ref": "#/components/responses/getUrl"
                    }
                }
            },
            "servers": [
                {
                    "description": "User Info Endpoint",
                    "url": "{urlBase}",
                    "variables": {
                        "UserInfoBaseUrl": {
                            "description": "Base part of url as passed in url query parameter",
                            "default": "https://card.dolden.net"
                        }
                    }
                }
            ],
            "parameters": [
                {
                    "name": "urlPath",
                    "in": "path",
                    "description": "Path part of url as passed in url query parameter",
                    "required": true
                }
            ]
        }
    },
    "components": {
        "schemas": {
            "getUrlResponse": {
                "description": "Get url response",
                "type": "object",
                "format": "encrypted using AES128, AES192 or AES256 and none IV",
                "properties": {
                    "card_balance": {
                        "description": "Standard claim and part of the Card Balance scope",
                        "type": "number"
                    },
                    "card_expire_date": {
                        "description": "Standard claim and part of the Card Info scope",
                        "type": "string",
                        "format": "date-time"
                    },
                    "card_expire_date_verified": {
                        "description": "Standard claim and part of the Card Info scope",
                        "type": "string",
                        "format": "date-time"
                    },
                    "card_number": {
                        "description": "Unique identifier of an eCard, standard claim and part of the Card Info scope",
                        "type": "string"
                    },
                    "card_number_verified": {
                        "description": "Standard claim and part of the Card Info scope",
                        "type": "string",
                        "format": "date-time"
                    },
                    "card_secret": {
                        "description": "PIN or security code of the (gift)card, standard claim and part of the Card Secret scope.",
                        "type": "string"
                    },
                    "card_secret_verified": {
                        "description": "Standard claim and part of the Card Secret scope.",
                        "type": "string",
                        "format": "date-time"
                    },
                    "email": {
                        "description": "Part of the Email scope",
                        "type": "string"
                    },
                    "email_verified": {
                        "description": "Part of the Email scope",
                        "type": "boolean"
                    },
                    "family_name": {
                        "description": "Part of the Profile scope",
                        "type": "string"
                    },
                    "given_name": {
                        "description": "Part of the Profile scope",
                        "type": "string"
                    },
                    "locale": {
                        "description": "Standard claim and part of the Locale scope",
                        "type": "string",
                        "format": "BCP47 with underscore ('_') support als alternative for the dash ('-')",
                        "example": "en-US"
                    },
                    "middle_name": {
                        "description": "Part of the Profile scope",
                        "type": "string"
                    },
                    "name": {
                        "description": "Part of the Profile scope",
                        "type": "string"
                    },
                    "nickname": {
                        "description": "Part of the Profile scope",
                        "type": "string"
                    },
                    "picture": {
                        "description": "Part of the Profile scope",
                        "type": "string",
                        "format": "binary"
                    },
                    "updated_at": {
                        "description": "Part of the Profile scope",
                        "type": "string",
                        "format": "date-time"
                    }
                }
            },
            "secret": {
                "description": "Secret used to encrypt the User Info.",
                "type": "string",
                "format": "Base64 URL encoded",
                "example": "KWpreJjLJR6_Q0W8-v_oSiF95_Fyoe7O4MTo1tghELk"
            },
            "url": {
                "description": "User Info Url.",
                "type": "string",
                "format": "url",
                "example": "https://card.dolden.net/ecards/v1/pub/dataExchange/SCXPNE2I3D4JU5NWDDTAXRCBBEJQWJX5"
            }
        },
        "responses": {
            "getUrl": {
                "description": "Get url response",
                "content": {
                    "application/json": {
                        "schema": {
                            "$ref": "#/components/schemas/getUrlResponse"
                        },
                        "examples": {
                            "example": {
                                "summary": "AES256 encrypted example",
                                "value": {
                                    "userInfo": "PlPY81WkHVqy+FAtUKs8vQXqXTRcsChw1KaEDB22DlTc3eN1IG3mr0759oOX5dCl6weacHMIBD6OtXGGmvslCA=="
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

